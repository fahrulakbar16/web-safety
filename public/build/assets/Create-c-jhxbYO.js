import{d as f,C as P,x as J,j as W,D as H,e as p,o as u,a as e,c as Q,t as m,m as x,E as X,G as Y,l as B,v,f as c,F as j,i as Z,r as ee,s as te,T as re,H as ae,u as oe,b as U,g as a,z as se,h as k,A as le,w as de,I as ne}from"./app-Fb0LGyY_.js";import{_ as ie}from"./AppLayout-D0XbQ-km.js";import{_ as ue}from"./Breadcrumb-CJPocqqf.js";import"./FlashMessage-CgKw3-1-.js";import"./useColors-BxdDnFDF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const pe=["disabled"],ce={class:"truncate"},me={class:"p-2"},ge=["onKeydown"],fe={class:"max-h-24 overflow-y-auto","data-simplebar":""},ye=["checked"],xe={class:"font-medium text-gray-700 dark:text-gray-300"},be=["onClick"],ke=["checked"],ve={key:1,class:"px-4 py-2 text-gray-500 italic"},he={__name:"Select",props:{items:{type:Array,default:()=>[]},modelValue:{type:[String,Number,null],default:null},label:{type:String,default:"Pilih Item"},taggable:{type:Boolean,default:!1},labelKey:{type:String,default:"name"},searchKey:{type:String,default:"name"},disabled:{type:Boolean,default:!1},persistKey:{type:String,default:null}},emits:["update:modelValue","create"],setup(K,{emit:A}){const C=`select-btn-${Math.random().toString(36).substr(2,9)}`,o=K,h=A,y=f(!1),g=f(""),F=f(null),_=f(null),S=f({}),r=f([]),$=P(()=>{if(!o.modelValue&&o.modelValue!==0)return null;const l=o.items.find(s=>s.id===o.modelValue)||r.value.find(s=>s.id===o.modelValue);if(l)return l;if(typeof o.modelValue=="string"&&o.modelValue){const s=o.modelValue.toString().toLowerCase();return o.items.find(i=>(i[o.labelKey]||"").toString().toLowerCase()===s)||r.value.find(i=>(i[o.labelKey]||"").toString().toLowerCase()===s)||null}return null}),E=P(()=>$.value?$.value[o.labelKey]:typeof o.modelValue=="string"&&o.modelValue?o.modelValue:o.label);function I(l){return o.labelKey&&l[o.labelKey]?l.type?.name?`${l[o.labelKey]} - ${l.type.name}`:l[o.labelKey]:l.name||""}const D=P(()=>{const l=(g.value||"").toLowerCase(),s=new Map,i=w=>{w.forEach(M=>{const L=(M[o.labelKey]||"").toString().toLowerCase();s.has(L)||s.set(L,M)})};return i(r.value),i(o.items||[]),Array.from(s.values()).filter(w=>{const M=(w[o.searchKey]||"").toString().toLowerCase(),L=I(w).toLowerCase();return M.includes(l)||L.includes(l)})});function T(){y.value=!y.value,y.value&&(g.value="",ae(()=>{n()}))}function n(){const l=document.getElementById(C);if(!l)return;const s=l.getBoundingClientRect(),i=200,b=window.innerHeight-s.bottom,w=s.top;b<i&&w>b?S.value={top:`${s.top-i}px`,left:`${s.left}px`,width:`${s.width}px`}:S.value={top:`${s.bottom+8}px`,left:`${s.left}px`,width:`${s.width}px`}}function t(){y.value=!1}function d(l){h("update:modelValue",l.id),t(),g.value=""}function V(){h("update:modelValue",null),t(),g.value=""}function R(l){return o.modelValue===l.id||typeof o.modelValue=="string"&&(l[o.labelKey]||"")===o.modelValue}function G(l){if(!y.value)return;const s=l.target,i=document.getElementById(C),b=i&&!i.contains(s),w=_.value&&!_.value.contains(s);b&&w&&t()}J(()=>o.modelValue,()=>{y.value}),W(()=>{if(document.addEventListener("click",G),window.addEventListener("scroll",n,!0),window.addEventListener("resize",n),o.persistKey)try{const l=localStorage.getItem(`select_local_${o.persistKey}`);l&&(r.value=JSON.parse(l))}catch{}}),H(()=>{if(document.removeEventListener("click",G),window.removeEventListener("scroll",n,!0),window.removeEventListener("resize",n),o.persistKey)try{localStorage.setItem(`select_local_${o.persistKey}`,JSON.stringify(r.value))}catch{}});const O=P(()=>o.items.some(l=>(l[o.searchKey]||"").toString().toLowerCase()===(g.value||"").toLowerCase())),N=P(()=>o.taggable&&!!g.value&&!O.value);function q(){if(!N.value)return;const l=(g.value||"").toString(),s=i=>i.some(b=>(b[o.labelKey]||"").toString().toLowerCase()===l.toLowerCase());if(!s(r.value)&&!s(o.items||[]))h("create",l);else{const i=[...o.items,...r.value].find(b=>(b[o.labelKey]||"").toString().toLowerCase()===l.toLowerCase());i&&h("update:modelValue",i.id)}t(),g.value=""}function z(){N.value&&q()}return(l,s)=>(u(),p("div",{class:"relative",ref_key:"dropdownWrapper",ref:F},[e("button",{id:C,onClick:T,disabled:o.disabled,type:"button",class:"w-full rounded-md border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 bg-white dark:bg-gray-700 dark:text-white dark:border-gray-600 flex justify-between items-center"},[e("span",ce,m(E.value),1),s[3]||(s[3]=e("svg",{class:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))],8,pe),(u(),Q(re,{to:"body"},[x(e("div",{ref_key:"dropdownElement",ref:_,style:te(S.value),class:"fixed mt-2 bg-white border border-gray-200 rounded-lg shadow-lg dark:bg-gray-700 dark:border-gray-600 z-[9999]"},[e("div",me,[x(e("input",{"onUpdate:modelValue":s[0]||(s[0]=i=>g.value=i),type:"text",placeholder:"Cari...",onKeydown:Y(B(z,["prevent"]),["enter"]),class:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-sky-500 dark:bg-gray-600 dark:text-white"},null,40,ge),[[v,g.value]])]),e("ul",fe,[e("li",{class:"px-4 py-2 cursor-pointer flex items-center gap-2 hover:bg-gray-100 dark:hover:bg-gray-600 border-b border-gray-200",onClick:V},[e("input",{type:"radio",class:"text-blue-600",checked:!o.modelValue||o.modelValue===null,onChange:s[1]||(s[1]=B(()=>{},["stop"]))},null,40,ye),e("span",xe,m(o.label),1)]),K.taggable&&N.value?(u(),p("li",{key:0,class:"px-4 py-2 cursor-pointer flex items-center gap-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-gray-600",onClick:q},' Tambah: "'+m(g.value)+'" ',1)):c("",!0),(u(!0),p(j,null,Z(D.value,i=>(u(),p("li",{key:i.id,class:"px-4 py-2 cursor-pointer flex items-center gap-2 hover:bg-gray-100 dark:hover:bg-gray-600",onClick:b=>d(i)},[e("input",{type:"radio",class:"text-blue-600",checked:R(i),onChange:s[2]||(s[2]=B(()=>{},["stop"]))},null,40,ke),ee(l.$slots,"item",{item:i},()=>[e("span",null,m(i[o.labelKey]||i.name),1)])],8,be))),128)),!K.taggable&&D.value.length===0?(u(),p("li",ve," Tidak ada hasil ")):c("",!0)])],4),[[X,y.value]])]))],512))}},we={class:"flex flex-col gap-3 px-3 h-full"},_e={class:"flex justify-between items-center h-10"},Se={class:"flex flex-col gap-6 p-6 overflow-auto rounded-lg border border-gray-200 bg-white dark:border-gray-600 dark:bg-white/[0.03]"},Ve={class:"space-y-4"},Ce={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Ke={class:"space-y-1 text-sm"},Fe={key:0,class:"text-sm text-red-500"},Me={class:"space-y-1 text-sm"},Pe={key:0,class:"text-sm text-red-500"},$e={class:"space-y-1 text-sm"},De={key:0,class:"text-sm text-red-500"},Le={class:"space-y-4"},Ue={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Be={class:"space-y-1 text-sm"},Ee={key:0,class:"text-sm text-red-500"},Ie={class:"space-y-1 text-sm"},Te={key:0,class:"text-sm text-red-500"},Ne={class:"space-y-1 text-sm"},Ae={key:0,class:"text-sm text-red-500"},Ge={class:"grid grid-cols-1 gap-4 md:grid-cols-3"},qe={class:"space-y-1 text-sm"},je={key:0,class:"text-sm text-red-500"},Re={class:"space-y-1 text-sm"},Oe={key:0,class:"text-sm text-red-500"},ze={class:"space-y-1 text-sm"},Je={key:0,class:"text-sm text-red-500"},We={class:"space-y-1 text-sm"},He={key:0,class:"text-sm text-red-500"},Qe={class:"space-y-4"},Xe={class:"grid grid-cols-1 gap-4 md:grid-cols-3"},Ye={class:"space-y-1 text-sm"},Ze={class:"flex flex-col gap-2"},et={key:0,class:"flex-shrink-0"},tt=["src"],rt={key:0,class:"text-sm text-red-500"},at={class:"space-y-1 text-sm"},ot={class:"flex flex-col gap-2"},st={key:0,class:"flex-shrink-0"},lt=["src"],dt={key:0,class:"text-sm text-red-500"},nt={class:"space-y-1 text-sm"},it={class:"flex flex-col gap-2"},ut={key:0,class:"flex-shrink-0"},pt=["src"],ct={key:0,class:"text-sm text-red-500"},mt={class:"flex gap-3 justify-end pt-4 border-t border-gray-200 dark:border-gray-600"},gt=["disabled"],ft={key:0},yt={key:1},_t=Object.assign({layout:ie},{__name:"Create",props:{companies:Array},setup(K){const C=f([...K.companies]),o=[{label:"Menu Utama"},{label:"Driver",url:route("drivers.index")},{label:"Tambah Driver"}],h=f(null),y=f(null),g=f(null),F=f(null),_=f(null),S=f(null),r=oe({company_id:null,name:"",alamat:"",no_hp:"",no_ktp:"",no_sim:"",foto_ktp:null,foto_sim:null,foto_diri:null,status:"pending",email:"",username:"",password:""}),$=n=>{const t=n.target.files[0];if(t){F.value=t;const d=new FileReader;d.onload=V=>{h.value=V.target.result},d.readAsDataURL(t)}},E=n=>{const t=n.target.files[0];if(t){_.value=t;const d=new FileReader;d.onload=V=>{y.value=V.target.result},d.readAsDataURL(t)}},I=n=>{const t=n.target.files[0];if(t){S.value=t;const d=new FileReader;d.onload=V=>{g.value=V.target.result},d.readAsDataURL(t)}},D=async n=>{try{const t=await window.axios.post(route("companies.quick-store"),{name:n});C.value.push(t.data.company),r.company_id=t.data.company.id}catch(t){console.error("Error creating company:",t);const d=t.response?.data?.message||t.message||"Gagal membuat perusahaan";alert("Gagal membuat perusahaan: "+d)}},T=()=>{const n=new FormData;n.append("company_id",r.company_id),n.append("name",r.name),n.append("alamat",r.alamat||""),n.append("no_hp",r.no_hp),n.append("no_ktp",r.no_ktp),n.append("no_sim",r.no_sim||""),n.append("status",r.status),n.append("email",r.email),n.append("username",r.username),n.append("password",r.password),F.value&&n.append("foto_ktp",F.value),_.value&&n.append("foto_sim",_.value),S.value&&n.append("foto_diri",S.value),r.post(route("drivers.store"),{forceFormData:!0,onSuccess:()=>{}})};return(n,t)=>(u(),p(j,null,[U(a(se),{title:"Tambah Driver"}),e("div",we,[e("div",_e,[U(ue,{items:o})]),e("div",Se,[t[31]||(t[31]=e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Tambah Driver Baru ",-1)),e("form",{onSubmit:B(T,["prevent"]),class:"space-y-6"},[e("div",Ve,[t[13]||(t[13]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," Informasi Akun ",-1)),e("div",Ce,[e("div",Ke,[t[10]||(t[10]=e("label",{for:"email",class:"text-gray-900 dark:text-white"},[k(" Email "),e("span",{class:"text-red-500"},"*")],-1)),x(e("input",{id:"email","onUpdate:modelValue":t[0]||(t[0]=d=>a(r).email=d),type:"email",class:"w-full text-sm font-medium placeholder-gray-500 text-gray-600 rounded-lg border-gray-400 placeholder:font-normal dark:border-white dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-blue-500 dark:focus:ring-blue-500",placeholder:"Masukkan email",required:""},null,512),[[v,a(r).email]]),a(r).errors.email?(u(),p("div",Fe,m(a(r).errors.email),1)):c("",!0)]),e("div",Me,[t[11]||(t[11]=e("label",{for:"username",class:"text-gray-900 dark:text-white"},[k(" Username "),e("span",{class:"text-red-500"},"*")],-1)),x(e("input",{id:"username","onUpdate:modelValue":t[1]||(t[1]=d=>a(r).username=d),type:"text",class:"w-full text-sm font-medium placeholder-gray-500 text-gray-600 rounded-lg border-gray-400 placeholder:font-normal dark:border-white dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-blue-500 dark:focus:ring-blue-500",placeholder:"Masukkan username",required:""},null,512),[[v,a(r).username]]),a(r).errors.username?(u(),p("div",Pe,m(a(r).errors.username),1)):c("",!0)]),e("div",$e,[t[12]||(t[12]=e("label",{for:"password",class:"text-gray-900 dark:text-white"},[k(" Password "),e("span",{class:"text-red-500"},"*")],-1)),x(e("input",{id:"password","onUpdate:modelValue":t[2]||(t[2]=d=>a(r).password=d),type:"password",class:"w-full text-sm font-medium placeholder-gray-500 text-gray-600 rounded-lg border-gray-400 placeholder:font-normal dark:border-white dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-blue-500 dark:focus:ring-blue-500",placeholder:"Masukkan password (min. 8 karakter)",required:""},null,512),[[v,a(r).password]]),a(r).errors.password?(u(),p("div",De,m(a(r).errors.password),1)):c("",!0)])])]),e("div",Le,[t[22]||(t[22]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," Informasi Driver ",-1)),e("div",Ue,[e("div",Be,[t[14]||(t[14]=e("label",{for:"company_id",class:"text-gray-900 dark:text-white"},[k(" Perusahaan "),e("span",{class:"text-red-500"},"*")],-1)),U(he,{modelValue:a(r).company_id,"onUpdate:modelValue":t[3]||(t[3]=d=>a(r).company_id=d),items:C.value,label:"Pilih Perusahaan","label-key":"name","search-key":"name",taggable:!0,onCreate:D},null,8,["modelValue","items"]),a(r).errors.company_id?(u(),p("div",Ee,m(a(r).errors.company_id),1)):c("",!0)]),e("div",Ie,[t[15]||(t[15]=e("label",{for:"name",class:"text-gray-900 dark:text-white"},[k(" Nama Driver "),e("span",{class:"text-red-500"},"*")],-1)),x(e("input",{id:"name","onUpdate:modelValue":t[4]||(t[4]=d=>a(r).name=d),type:"text",class:"w-full text-sm font-medium placeholder-gray-500 text-gray-600 rounded-lg border-gray-400 placeholder:font-normal dark:border-white dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-blue-500 dark:focus:ring-blue-500",placeholder:"Masukkan nama driver",required:""},null,512),[[v,a(r).name]]),a(r).errors.name?(u(),p("div",Te,m(a(r).errors.name),1)):c("",!0)])]),e("div",Ne,[t[16]||(t[16]=e("label",{for:"alamat",class:"text-gray-900 dark:text-white"},[k(" Alamat "),e("span",{class:"text-red-500"},"*")],-1)),x(e("textarea",{id:"alamat","onUpdate:modelValue":t[5]||(t[5]=d=>a(r).alamat=d),rows:"3",class:"w-full text-sm font-medium placeholder-gray-500 text-gray-600 rounded-lg border-gray-400 placeholder:font-normal dark:border-white dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-blue-500 dark:focus:ring-blue-500",placeholder:"Masukkan alamat driver",required:""},null,512),[[v,a(r).alamat]]),a(r).errors.alamat?(u(),p("div",Ae,m(a(r).errors.alamat),1)):c("",!0)]),e("div",Ge,[e("div",qe,[t[17]||(t[17]=e("label",{for:"no_hp",class:"text-gray-900 dark:text-white"},[k(" Nomor HP "),e("span",{class:"text-red-500"},"*")],-1)),x(e("input",{id:"no_hp","onUpdate:modelValue":t[6]||(t[6]=d=>a(r).no_hp=d),type:"text",class:"w-full text-sm font-medium placeholder-gray-500 text-gray-600 rounded-lg border-gray-400 placeholder:font-normal dark:border-white dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-blue-500 dark:focus:ring-blue-500",placeholder:"08xxxxxxxxxx",required:""},null,512),[[v,a(r).no_hp]]),a(r).errors.no_hp?(u(),p("div",je,m(a(r).errors.no_hp),1)):c("",!0)]),e("div",Re,[t[18]||(t[18]=e("label",{for:"no_ktp",class:"text-gray-900 dark:text-white"},[k(" Nomor KTP "),e("span",{class:"text-red-500"},"*")],-1)),x(e("input",{id:"no_ktp","onUpdate:modelValue":t[7]||(t[7]=d=>a(r).no_ktp=d),type:"text",class:"w-full text-sm font-medium placeholder-gray-500 text-gray-600 rounded-lg border-gray-400 placeholder:font-normal dark:border-white dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-blue-500 dark:focus:ring-blue-500",placeholder:"Masukkan nomor KTP",required:""},null,512),[[v,a(r).no_ktp]]),a(r).errors.no_ktp?(u(),p("div",Oe,m(a(r).errors.no_ktp),1)):c("",!0)]),e("div",ze,[t[19]||(t[19]=e("label",{for:"no_sim",class:"text-gray-900 dark:text-white"}," Nomor SIM ",-1)),x(e("input",{id:"no_sim","onUpdate:modelValue":t[8]||(t[8]=d=>a(r).no_sim=d),type:"text",class:"w-full text-sm font-medium placeholder-gray-500 text-gray-600 rounded-lg border-gray-400 placeholder:font-normal dark:border-white dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-blue-500 dark:focus:ring-blue-500",placeholder:"Masukkan nomor SIM"},null,512),[[v,a(r).no_sim]]),a(r).errors.no_sim?(u(),p("div",Je,m(a(r).errors.no_sim),1)):c("",!0)])]),e("div",We,[t[21]||(t[21]=e("label",{for:"status",class:"text-gray-900 dark:text-white"},[k(" Status "),e("span",{class:"text-red-500"},"*")],-1)),x(e("select",{id:"status","onUpdate:modelValue":t[9]||(t[9]=d=>a(r).status=d),class:"block p-2.5 w-full text-sm text-gray-600 rounded-lg border-gray-400 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},[...t[20]||(t[20]=[e("option",{value:"pending"},"Menunggu Verifikasi",-1),e("option",{value:"active"},"Aktif",-1),e("option",{value:"inactive"},"Tidak Aktif",-1)])],512),[[le,a(r).status]]),a(r).errors.status?(u(),p("div",He,m(a(r).errors.status),1)):c("",!0)])]),e("div",Qe,[t[29]||(t[29]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," Upload Foto ",-1)),e("div",Xe,[e("div",Ye,[t[24]||(t[24]=e("label",{for:"foto_ktp",class:"text-gray-900 dark:text-white"}," Foto KTP ",-1)),e("div",Ze,[h.value?(u(),p("div",et,[e("img",{src:h.value,alt:"Foto KTP Preview",class:"w-full h-32 object-contain border border-gray-200 rounded-lg"},null,8,tt)])):c("",!0),e("input",{type:"file",accept:"image/*",onChange:$,class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32),t[23]||(t[23]=e("p",{class:"text-xs text-gray-500"}," Format: JPG, PNG, GIF, WEBP. Maks. 2MB ",-1))]),a(r).errors.foto_ktp?(u(),p("div",rt,m(a(r).errors.foto_ktp),1)):c("",!0)]),e("div",at,[t[26]||(t[26]=e("label",{for:"foto_sim",class:"text-gray-900 dark:text-white"}," Foto SIM ",-1)),e("div",ot,[y.value?(u(),p("div",st,[e("img",{src:y.value,alt:"Foto SIM Preview",class:"w-full h-32 object-contain border border-gray-200 rounded-lg"},null,8,lt)])):c("",!0),e("input",{type:"file",accept:"image/*",onChange:E,class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32),t[25]||(t[25]=e("p",{class:"text-xs text-gray-500"}," Format: JPG, PNG, GIF, WEBP. Maks. 2MB ",-1))]),a(r).errors.foto_sim?(u(),p("div",dt,m(a(r).errors.foto_sim),1)):c("",!0)]),e("div",nt,[t[28]||(t[28]=e("label",{for:"foto_diri",class:"text-gray-900 dark:text-white"}," Foto Diri ",-1)),e("div",it,[g.value?(u(),p("div",ut,[e("img",{src:g.value,alt:"Foto Diri Preview",class:"w-full h-32 object-contain border border-gray-200 rounded-lg"},null,8,pt)])):c("",!0),e("input",{type:"file",accept:"image/*",onChange:I,class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32),t[27]||(t[27]=e("p",{class:"text-xs text-gray-500"}," Format: JPG, PNG, GIF, WEBP. Maks. 2MB ",-1))]),a(r).errors.foto_diri?(u(),p("div",ct,m(a(r).errors.foto_diri),1)):c("",!0)])])]),e("div",mt,[U(a(ne),{href:n.route("drivers.index"),class:"px-4 py-2 text-gray-700 bg-gray-100 rounded hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"},{default:de(()=>[...t[30]||(t[30]=[k(" Batal ",-1)])]),_:1},8,["href"]),e("button",{type:"submit",disabled:a(r).processing,class:"px-4 py-2 text-white rounded btn-primary disabled:opacity-50"},[a(r).processing?(u(),p("span",ft,"Menyimpan...")):(u(),p("span",yt,"Simpan"))],8,gt)])],32)])])],64))}});export{_t as default};
