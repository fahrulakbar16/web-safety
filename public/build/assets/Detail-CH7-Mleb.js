import{a2 as L,C as O,d as w,u as k,D as V,e as i,o as n,a as e,t as a,f as c,s as v,g as t,n as B,l as N,m as g,v as x,h as A,y as D}from"./app-Fb0LGyY_.js";import{S as _}from"./sweetalert2.esm.all-Dr03eess.js";import{u as F}from"./useColors-BxdDnFDF.js";const T={class:"overflow-hidden bg-white shadow sm:rounded-lg"},z={class:"flex items-center justify-between px-6 py-4 border-b"},M={class:"text-lg font-semibold text-gray-800"},G={class:"flex items-center gap-2"},K={key:0,class:"grid grid-cols-1 lg:grid-cols-[320px,1fr]"},q={class:"flex flex-col items-center justify-center gap-4 p-8 border-b lg:border-b-0 lg:border-r"},H=["src"],I={class:"p-8"},J={class:"grid grid-cols-1 gap-y-5 gap-x-12 sm:grid-cols-2"},Q={class:"mt-1 text-base font-semibold text-gray-900"},W={class:"mt-1 text-base font-semibold text-gray-900"},X={class:"mt-1 font-medium"},Y={class:"mt-1 font-medium"},Z={class:"mt-1 font-medium"},$={class:"flex flex-col items-center justify-center gap-4 p-8 border-b lg:border-b-0 lg:border-r"},ee=["src"],se={class:"p-8"},te={class:"grid grid-cols-1 gap-4"},oe={class:"space-y-1"},re={key:0,class:"text-sm text-red-600"},le={class:"space-y-1"},ae={key:0,class:"text-sm text-red-600"},ie={class:"space-y-1"},ne={key:0,class:"text-sm text-red-600"},de={class:"space-y-1"},ue={key:0,class:"text-sm text-red-600"},pe={class:"space-y-1"},me={key:0,class:"text-sm text-red-600"},ce={class:"space-y-1"},fe={class:"flex items-center gap-3"},ge={class:"px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md cursor-pointer hover:bg-indigo-700"},xe={class:"text-sm text-gray-600 truncate"},ye={key:0,class:"text-sm text-red-600"},be={class:"flex items-center gap-2 pt-2"},ve=["disabled"],ke={__name:"Detail",props:{user:{type:Object,default:null}},setup(U){const P=U,C=L(),{colors:h,withOpacity:y}=F(),o=O(()=>P.user??C.props.auth?.user??{}),f=w(!1),p=w(o.value?.profile_photo_url||null);let d=null;const l=k({name:o.value?.name||"",email:o.value?.email||"",photo:null});function j(m){const s=m.target.files?.[0];l.photo=s||null,d&&URL.revokeObjectURL(d),s?(d=URL.createObjectURL(s),p.value=d):p.value=o?.profile_photo_url||null}V(()=>{d&&URL.revokeObjectURL(d)});const r=k({current_password:"",password:"",password_confirmation:""}),b=w(!1);function E(){l.name=o.value?.name||"",l.email=o.value?.email||"",l.photo=null,p.value=o.value?.profile_photo_url||null,r.current_password="",r.password="",r.password_confirmation="",f.value=!0}function R(){f.value=!1,l.reset("photo"),r.reset(),d&&URL.revokeObjectURL(d),d=null,p.value=o.value?.profile_photo_url||null}async function S(){b.value=!0;let m=!1;try{await l.transform(s=>({...s,_method:"PUT"})).post(route("user-profile-information.update"),{preserveScroll:!0,forceFormData:!0,onError:()=>{m=!0}}),(r.current_password||r.password||r.password_confirmation)&&await r.put(route("user-password.update"),{preserveScroll:!0,onError:()=>{m=!0}}),(l.hasErrors||r.hasErrors)&&(m=!0),m?_.fire({icon:"error",title:"Gagal",text:"Profil tidak dapat diperbarui. Periksa kembali data yang Anda masukkan."}):(l.reset("photo"),r.reset(),d&&(URL.revokeObjectURL(d),d=null),await D.reload({only:["auth"]}),p.value=o.value?.profile_photo_url||null,f.value=!1,_.fire({icon:"success",title:"Berhasil",text:"Profil berhasil diperbarui.",timer:1500,showConfirmButton:!1}))}catch(s){console.error(s),_.fire({icon:"error",title:"Kesalahan",text:"Terjadi kesalahan pada server. Silakan coba lagi nanti."})}finally{b.value=!1}}return(m,s)=>(n(),i("div",T,[e("div",z,[e("h3",M,a(f.value?"Ubah Data Profile":"Profil"),1),e("div",G,[f.value?c("",!0):(n(),i("button",{key:0,type:"button",onClick:E,class:"inline-flex items-center px-3 py-2 text-sm font-medium text-white rounded-md btn-primary"}," Ubah Profile "))])]),f.value?(n(),i("form",{key:1,onSubmit:N(S,["prevent"]),class:"grid grid-cols-1 lg:grid-cols-[320px,1fr]"},[e("div",$,[e("div",{class:"flex items-center justify-center w-56 h-56 overflow-hidden rounded-full",style:v([{backgroundColor:t(y)("primary",.1),borderColor:t(y)("primary",.2)},{border:"1px solid"}])},[p.value?(n(),i("img",{key:0,src:p.value,alt:"Profile",class:"object-cover w-full h-full"},null,8,ee)):(n(),i("span",{key:1,class:"text-6xl font-semibold select-none",style:v({color:t(h).primary})},a((o.value?.name||o.value?.username||"?").toString().charAt(0).toUpperCase()),5))],4),s[11]||(s[11]=e("p",{class:"text-sm text-gray-500"},"Pratinjau foto profil",-1))]),e("div",se,[e("div",te,[e("label",oe,[s[12]||(s[12]=e("span",{class:"text-sm text-gray-700"},"Name",-1)),g(e("input",{"onUpdate:modelValue":s[0]||(s[0]=u=>t(l).name=u),type:"text",autocomplete:"name",class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[x,t(l).name]]),t(l).errors.name?(n(),i("span",re,a(t(l).errors.name),1)):c("",!0)]),e("label",le,[s[13]||(s[13]=e("span",{class:"text-sm text-gray-700"},"Email Address",-1)),g(e("input",{"onUpdate:modelValue":s[1]||(s[1]=u=>t(l).email=u),type:"email",autocomplete:"email",class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[x,t(l).email]]),t(l).errors.email?(n(),i("span",ae,a(t(l).errors.email),1)):c("",!0)]),e("label",ie,[s[14]||(s[14]=e("span",{class:"text-sm text-gray-700"},"Old Password",-1)),g(e("input",{"onUpdate:modelValue":s[2]||(s[2]=u=>t(r).current_password=u),type:"password",autocomplete:"current-password",class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[x,t(r).current_password]]),t(r).errors.current_password?(n(),i("span",ne,a(t(r).errors.current_password),1)):c("",!0)]),e("label",de,[s[15]||(s[15]=e("span",{class:"text-sm text-gray-700"},"New Password",-1)),g(e("input",{"onUpdate:modelValue":s[3]||(s[3]=u=>t(r).password=u),type:"password",autocomplete:"new-password",class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[x,t(r).password]]),t(r).errors.password?(n(),i("span",ue,a(t(r).errors.password),1)):c("",!0)]),e("label",pe,[s[16]||(s[16]=e("span",{class:"text-sm text-gray-700"},"Confirm Password",-1)),g(e("input",{"onUpdate:modelValue":s[4]||(s[4]=u=>t(r).password_confirmation=u),type:"password",autocomplete:"new-password",class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[x,t(r).password_confirmation]]),t(r).errors.password_confirmation?(n(),i("span",me,a(t(r).errors.password_confirmation),1)):c("",!0)]),e("div",ce,[s[18]||(s[18]=e("span",{class:"text-sm text-gray-700"},"Change Profile Photo",-1)),e("div",fe,[e("label",ge,[s[17]||(s[17]=A(" Choose File ",-1)),e("input",{type:"file",accept:"image/*",class:"hidden",onChange:j},null,32)]),e("span",xe,a(t(l).photo?t(l).photo.name:"No file chosen"),1)]),t(l).errors.photo?(n(),i("span",ye,a(t(l).errors.photo),1)):c("",!0)]),e("div",be,[e("button",{type:"submit",disabled:b.value,class:"inline-flex items-center px-4 py-2 text-sm font-medium text-white rounded-md btn-primary disabled:opacity-50"},a(b.value?"Updating...":"Update Profile"),9,ve),e("button",{type:"button",onClick:R,class:"inline-flex items-center px-3 py-2 text-sm font-medium text-gray-700 bg-white border rounded-md hover:bg-gray-50"}," Batal ")])])])],32)):(n(),i("div",K,[e("div",q,[e("div",{class:"flex items-center justify-center w-56 h-56 overflow-hidden rounded-full",style:v([{backgroundColor:t(y)("primary",.1),borderColor:t(y)("primary",.2)},{border:"1px solid"}])},[o.value?.profile_photo_url?(n(),i("img",{key:0,src:o.value.profile_photo_url,alt:"Profile",class:"object-cover w-full h-full"},null,8,H)):(n(),i("span",{key:1,class:"text-6xl font-semibold select-none",style:v({color:t(h).primary})},a((o.value?.name||o.value?.username||"?").toString().charAt(0).toUpperCase()),5))],4),s[5]||(s[5]=e("p",{class:"text-sm text-gray-500"},"Foto profil saat ini",-1))]),e("div",I,[e("dl",J,[e("div",null,[s[6]||(s[6]=e("dt",{class:"text-sm text-gray-500"},"Name",-1)),e("dd",Q,a(o.value?.name||"-"),1)]),e("div",null,[s[7]||(s[7]=e("dt",{class:"text-sm text-gray-500"},"Email Address",-1)),e("dd",W,a(o.value?.email||"-"),1)]),e("div",null,[s[8]||(s[8]=e("dt",{class:"text-sm text-gray-500"},"Username",-1)),e("dd",X,a(o.value?.username||"-"),1)]),e("div",null,[s[9]||(s[9]=e("dt",{class:"text-sm text-gray-500"},"Role",-1)),e("dd",Y,a(o.value?.role||o.value?.roles?.[0]?.name||"-"),1)]),e("div",null,[s[10]||(s[10]=e("dt",{class:"text-sm text-gray-500"},"Status",-1)),e("dd",Z,[e("span",{class:B(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",o.value?.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"])},a(o.value?.status||"-"),3)])])])])]))]))}};export{ke as default};
